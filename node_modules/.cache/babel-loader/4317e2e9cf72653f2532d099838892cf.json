{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n/**\n * This middleware modifies the input on S3 CreateBucket requests.  If the LocationConstraint has not been set, this\n * middleware will set a LocationConstraint to match the configured region.  The CreateBucketConfiguration will be\n * removed entirely on requests to the us-east-1 region.\n */\n\n\nfunction locationConstraintMiddleware(options) {\n  var _this = this;\n\n  return function (next) {\n    return function (args) {\n      return tslib_1.__awaiter(_this, void 0, void 0, function () {\n        var CreateBucketConfiguration, region;\n        return tslib_1.__generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              CreateBucketConfiguration = args.input.CreateBucketConfiguration;\n              return [4\n              /*yield*/\n              , options.region()];\n\n            case 1:\n              region = _a.sent();\n\n              if (!CreateBucketConfiguration || !CreateBucketConfiguration.LocationConstraint) {\n                args = tslib_1.__assign(tslib_1.__assign({}, args), {\n                  input: tslib_1.__assign(tslib_1.__assign({}, args.input), {\n                    CreateBucketConfiguration: region === \"us-east-1\" ? undefined : {\n                      LocationConstraint: region\n                    }\n                  })\n                });\n              }\n\n              return [2\n              /*return*/\n              , next(args)];\n          }\n        });\n      });\n    };\n  };\n}\n\nexports.locationConstraintMiddleware = locationConstraintMiddleware;\nexports.locationConstraintMiddlewareOptions = {\n  step: \"initialize\",\n  tags: [\"LOCATION_CONSTRAINT\", \"CREATE_BUCKET_CONFIGURATION\"],\n  name: \"locationConstraintMiddleware\"\n};\n\nexports.getLocationConstraintPlugin = function (config) {\n  return {\n    applyToStack: function applyToStack(clientStack) {\n      clientStack.add(locationConstraintMiddleware(config), exports.locationConstraintMiddlewareOptions);\n    }\n  };\n};","map":null,"metadata":{},"sourceType":"script"}