{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nfunction getDeserializingStream(messageStream, deserializer) {\n  var messageReader = messageStream.getReader();\n  var deserializedStream = new ReadableStream({\n    start: function start(controller) {\n      function push() {\n        var _this = this;\n\n        messageReader.read().then(function (_a) {\n          var done = _a.done,\n              value = _a.value;\n          return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var _b, _c, e_1;\n\n            return tslib_1.__generator(this, function (_d) {\n              switch (_d.label) {\n                case 0:\n                  if (done) {\n                    controller.close();\n                    return [2\n                    /*return*/\n                    ];\n                  }\n\n                  _d.label = 1;\n\n                case 1:\n                  _d.trys.push([1, 3,, 4]);\n\n                  _c = (_b = controller).enqueue;\n                  return [4\n                  /*yield*/\n                  , deserializer(value)];\n\n                case 2:\n                  _c.apply(_b, [_d.sent()]);\n\n                  push();\n                  return [3\n                  /*break*/\n                  , 4];\n\n                case 3:\n                  e_1 = _d.sent();\n                  controller.error(e_1);\n                  return [3\n                  /*break*/\n                  , 4];\n\n                case 4:\n                  return [2\n                  /*return*/\n                  ];\n              }\n            });\n          });\n        });\n      }\n\n      push();\n    }\n  });\n  return deserializedStream;\n}\n\nexports.getDeserializingStream = getDeserializingStream;","map":null,"metadata":{},"sourceType":"script"}